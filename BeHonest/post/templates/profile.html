{% extends 'base.html' %}
{% block content %}
    <section>
        {% comment %} fluid container will left align {% endcomment %}
        <div class="container py-3 h-100">
            <div class="row d-flex justify-content-left align-items-center h-90">
                <div class="col-md-12 col-xl-4">
                    <div class="card" style="border-radius: 15px;">
                        <div class="card-body text-center">
                        <div class="mt-3 mb-4">
                            <img src="https://media.istockphoto.com/id/1070887284/vector/cat-in-round-sunglasses-icon.jpg?s=612x612&w=0&k=20&c=DNMRexAgX06ygBX97tUFLUinMYJELguN8qb9ty9Uj9Q="
                            class="rounded-circle img-fluid" style="width: 100px;" />
                        </div>
                        <h4 class="mb-2">{{ user.username }}</h4>
                        <p class="text-muted mb-4">BeHonest<span class="mx-2">|</span>
                            proud member</p>
                        <div class="d-flex justify-content-between text-center mt-5 mb-2">
                            <div>
                            <p class="mb-2 h5">{{friends|length}}</p>
                            <p class="text-muted mb-0">Number of Friends</p>
                            </div>
                            <div class="px-3">
                            <p class="mb-2 h5">{{ posts|length }}</p>
                            <p class="text-muted mb-0">Number of Posts</p>
                            </div>
                            <div>
                            <p class="mb-2 h5">GOAT</p>
                            <p class="text-muted mb-0">Tier</p>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
            <div>
                <div class = "container">
                    {% if badges %}
                        <p>Number of Badges: {{ badges|length }}</p>
                    {%endif%}
                
                    <div class = "card">
                        {% for badge in badges %}
                        <p> {{badge}} </p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div>
        <div class = "container">
            {% if authenticated_user != user%}
                {% if not isFriend and not alreadySent%}
                    <form method="POST" action="/send_friend_request">
                        {% csrf_token %}
                        <input type = "hidden" name="receiver" value="{{user.username}}">

                        <button type="submit">add friend</button>

                
                    </form>
                {% elif alreadySent and not isFriend%}
                        <h1>your friend request is pending</h1>
                    
                {% endif %}
            {% endif %}

            {% if authenticated_user == user %}
                <div class = "container">
                    <div class = "card">
                        <p>friend reqs</p>
                        {% for req in friend_requests %}
                        <form method="POST" action="/accept_friend_request">
                            {% csrf_token %}
                            <div class="card-header">
                                <p>{{ req.sender }}</p>
                                <input type="hidden" name="sender" value="{{req.sender}}">
                                <button>accept?</button>
                            </div>                                    
                            <br>
                        </form>
                        {% endfor %}
                    </div>
                </div>
                <div class = "container">
                    <div class = "card">
                        <p>friends</p>
                        {% for friend in friends %}
                                <p>{{ friend.secondary }}</p>
                            <br>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
    {% comment %} {% if authenticated_user != user%}
        {% if not isFriend and not alreadySent%}
            <form method="POST" action="/send_friend_request">
                {% csrf_token %}
                <input type = "hidden" name="receiver" value="{{user.username}}">

                <button type="submit">add friend</button>

        
            </form>
        {% elif alreadySent and not isFriend%}
                <h1>your friend request is pending</h1>
            
        {% endif %}
    {% endif %}

    {% if authenticated_user == user %}
        <div class = "container">
            <div class = "card">
                <h1>friend reqs</h1>
                {% for req in friend_requests %}
                <form method="POST" action="/accept_friend_request">
                    {% csrf_token %}
                    <div class="card-header">
                        <h4>{{ req.sender }}</p>
                        <input type="hidden" name="sender" value="{{req.sender}}">
                        <button>accept?</button>
                    </div>
                    
                    <br>
                </form>
                {% endfor %}
            </div>
        </div>
        <div class = "container">
            <div class = "card">
                <h1>friends</h1>
                {% for friend in friends %}
                        <h4>{{ friend.secondary }}</p>
                    <br>
                {% endfor %}
            </div>
        </div>
    {% endif %} {% endcomment %}
    <br>
    <div class = "container">
        <h4 class = "display-5 text-center"> {{ user.username }}'s Post History</h4>
        <div class = "card">
            
            {% for post in posts %}
                <div class="card-header">
                    <h4>{{ post.title }}</p>
                </div>
                <div class="card-body">
                    <blockquote class = "blockquote mb-0">
                        <p>{{ post.content }}</p>
                        
                        <footer class="blockquote-footer">{{post.created_on}}<cite title="Source Title">{{post.author.username}}</cite></footer>
                    </blockquote>
                </div>
                <p>Likes: {{ post.total_likes }} Dislikes: {{ post.total_dislikes }}</p>
                <br>
            {% endfor %}
        </div>        
    </div>
    
    <!-- Display badges -->
    {% comment %} <div class = "container">
        {% if badges %}
            <p>Number of Badges: {{ badges|length }}</p>
        {%endif%}
        
        <div class = "card">
            {% for badge in badges %}
            <p> {{badge}} </p>
            {% endfor %}
        </div>
    </div> {% endcomment %}
    
    
{% endblock %}